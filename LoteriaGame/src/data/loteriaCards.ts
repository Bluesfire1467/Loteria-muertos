import type { LoteriaCard } from '../types'

/**
 * Cartas tradicionales de la Lotería Mexicana seleccionadas para el juego
 * Incluye cartas con significado especial para el Día de Muertos
 */
export const LOTERIA_CARDS: LoteriaCard[] = [
  {
    id: 1,
    name: 'La Muerte',
    image: 'svg',
    description: 'La flaca bonita',
    culturalSignificance: 'Figura central del Día de Muertos, representa la transición entre la vida y la muerte, celebrada con respeto y alegría en la cultura mexicana.'
  },
  {
    id: 2,
    name: 'El Corazón',
    image: 'svg',
    description: 'No me olvides',
    culturalSignificance: 'Símbolo del amor eterno y la memoria de los seres queridos que han partido, elemento fundamental en las ofrendas del Día de Muertos.'
  },
  {
    id: 3,
    name: 'La Rosa',
    image: 'svg',
    description: 'La que se dio a todos',
    culturalSignificance: 'Representa la belleza efímera de la vida y se usa para decorar las tumbas y altares durante las celebraciones del Día de Muertos.'
  },
  {
    id: 4,
    name: 'El Sol',
    image: 'svg',
    description: 'La cobija de los pobres',
    culturalSignificance: 'Simboliza la luz que guía a las almas de regreso a casa durante el Día de Muertos, elemento esencial en la cosmogonía mexicana.'
  },
  {
    id: 5,
    name: 'La Luna',
    image: 'svg',
    description: 'El farol de los enamorados',
    culturalSignificance: 'Representa el ciclo de la vida y la muerte, y se cree que durante la luna llena las almas pueden regresar más fácilmente al mundo de los vivos.'
  },
  {
    id: 6,
    name: 'La Estrella',
    image: 'svg',
    description: 'La guía de los marineros',
    culturalSignificance: 'Simboliza la esperanza y la guía espiritual, ayudando a las almas a encontrar su camino durante el Día de Muertos.'
  },
  {
    id: 7,
    name: 'El Árbol',
    image: 'svg',
    description: 'El que a todos cobija',
    culturalSignificance: 'Representa la conexión entre el mundo de los vivos y los muertos, sus raíces en la tierra y ramas hacia el cielo simbolizan esta unión.'
  },
  {
    id: 8,
    name: 'La Calavera',
    image: 'svg',
    description: 'Al que le toque',
    culturalSignificance: 'Icono principal del Día de Muertos, representa la muerte de manera festiva y colorida, recordando que la muerte es parte natural de la vida.'
  },
  {
    id: 9,
    name: 'El Diablo',
    image: 'svg',
    description: 'Portate bien cuatito',
    culturalSignificance: 'Figura que en el contexto del Día de Muertos representa las fuerzas sobrenaturales y el equilibrio entre el bien y el mal.'
  },
  {
    id: 10,
    name: 'La Sirena',
    image: 'svg',
    description: 'Con los cantos de sirena',
    culturalSignificance: 'Representa las almas que navegan entre mundos, cantando para guiar a otros espíritus durante su viaje de regreso.'
  },
  {
    id: 11,
    name: 'El Músico',
    image: 'svg',
    description: 'El que toca la guitarra',
    culturalSignificance: 'La música es fundamental en las celebraciones del Día de Muertos, se cree que las melodías ayudan a llamar a las almas de los difuntos.'
  },
  {
    id: 12,
    name: 'La Dama',
    image: 'svg',
    description: 'Puliendo el paso por toda la calle',
    culturalSignificance: 'Representa la elegancia y dignidad con la que se debe honrar a los muertos, vestirse de gala para recibirlos en su visita anual.'
  },
  {
    id: 13,
    name: 'El Catrin',
    image: 'svg',
    description: 'Don Ferruco en el baile',
    culturalSignificance: 'Inspirado en la Catrina de José Guadalupe Posada, representa la igualdad ante la muerte sin importar la clase social.'
  },
  {
    id: 14,
    name: 'La Campana',
    image: 'svg',
    description: 'Tú con la campana y yo con el badajo',
    culturalSignificance: 'Su sonido anuncia momentos importantes y se cree que ayuda a guiar a las almas durante el Día de Muertos.'
  },
  {
    id: 15,
    name: 'El Mundo',
    image: 'svg',
    description: 'Este mundo es una bola',
    culturalSignificance: 'Representa la totalidad de la existencia, incluyendo el mundo de los vivos y el de los muertos, unidos durante las celebraciones.'
  },
  {
    id: 16,
    name: 'La Mano',
    image: 'svg',
    description: 'La mano del criminal',
    culturalSignificance: 'Simboliza las acciones que realizamos en vida y que nos acompañan en el más allá, recordando la importancia de nuestros actos.'
  },
  {
    id: 17,
    name: 'El Pescado',
    image: 'svg',
    description: 'El que por la boca muere',
    culturalSignificance: 'Representa la abundancia y la provisión, elementos importantes en las ofrendas del Día de Muertos para alimentar a las almas visitantes.'
  },
  {
    id: 18,
    name: 'La Palma',
    image: 'svg',
    description: 'Llevame a la palma',
    culturalSignificance: 'Símbolo de victoria y triunfo espiritual, representa la elevación del alma hacia planos superiores durante el Día de Muertos.'
  },
  {
    id: 19,
    name: 'La Maceta',
    image: 'svg',
    description: 'El que nace pa maceta',
    culturalSignificance: 'Representa el cuidado y cultivo de la memoria, como las flores de cempasúchil que se cultivan especialmente para honrar a los muertos.'
  },
  {
    id: 20,
    name: 'El Arpa',
    image: 'svg',
    description: 'Arpa vieja de mi suegra',
    culturalSignificance: 'La música celestial que acompaña a las almas en su viaje, elemento fundamental en las celebraciones del Día de Muertos.'
  },
  {
    id: 21,
    name: 'La Rana',
    image: 'svg',
    description: 'Al ver a la rana',
    culturalSignificance: 'Símbolo de transformación y renacimiento, representa el ciclo continuo de la vida y la muerte en la cosmovisión mexicana.'
  },
  {
    id: 22,
    name: 'El Nopal',
    image: 'svg',
    description: 'Al nopal lo van a ver',
    culturalSignificance: 'Planta sagrada mexicana que representa la resistencia y la supervivencia, elementos centrales en la celebración de la vida y la muerte.'
  },
  {
    id: 23,
    name: 'El Soldado',
    image: 'svg',
    description: 'Don ferruco en el cuartel',
    culturalSignificance: 'Representa a los caídos en batalla, honrados especialmente durante el Día de Muertos como héroes que dieron su vida por la patria.'
  },
  {
    id: 24,
    name: 'La Corona',
    image: 'svg',
    description: 'La corona del rey',
    culturalSignificance: 'Símbolo de dignidad y honor, recordando que en la muerte todos somos iguales, sin importar el estatus que tuvimos en vida.'
  },
  {
    id: 25,
    name: 'El Paraguas',
    image: 'svg',
    description: 'Para el sol y para el agua',
    culturalSignificance: 'Protección espiritual para las almas en su viaje entre mundos, elemento simbólico de cuidado y amparo divino.'
  }
]

/**
 * Obtiene una carta por su ID
 */
export const getCardById = (id: number): LoteriaCard | undefined => {
  return LOTERIA_CARDS.find(card => card.id === id)
}

/**
 * Obtiene una carta por su nombre
 */
export const getCardByName = (name: string): LoteriaCard | undefined => {
  return LOTERIA_CARDS.find(card => card.name.toLowerCase() === name.toLowerCase())
}

/**
 * Obtiene cartas aleatorias para un tablero de juego
 * Asegura que no haya cartas duplicadas
 */
export const getRandomCards = (count: number): LoteriaCard[] => {
  if (count > LOTERIA_CARDS.length) {
    console.warn(`Se solicitaron ${count} cartas pero solo hay ${LOTERIA_CARDS.length} disponibles`)
    count = LOTERIA_CARDS.length
  }
  
  // Crear una copia del array y mezclarlo usando Fisher-Yates
  const shuffled = [...LOTERIA_CARDS]
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]]
  }
  
  const selectedCards = shuffled.slice(0, count)
  
  // Verificar que no hay duplicados
  const cardIds = selectedCards.map(c => c.id)
  const uniqueIds = new Set(cardIds)
  if (cardIds.length !== uniqueIds.size) {
    console.error(`⚠️ PROBLEMA: Se detectaron cartas duplicadas en el tablero!`, selectedCards)
  }
  
  console.log(`🎲 Generadas ${selectedCards.length} cartas aleatorias para tablero`)
  
  return selectedCards
}

/**
 * Obtiene todas las cartas con significado cultural del Día de Muertos
 */
export const getDayOfTheDeadCards = (): LoteriaCard[] => {
  return LOTERIA_CARDS.filter(card => card.culturalSignificance)
}

/**
 * Constantes del juego
 */
export const GAME_CONSTANTS = {
  TOTAL_CARDS: LOTERIA_CARDS.length,
  BOARD_SIZE: 16, // 4x4 grid
  MIN_CARDS_FOR_GAME: 16,
  MAX_PLAYERS: 4
} as const